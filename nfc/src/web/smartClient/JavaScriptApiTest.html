<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" language="javascript"
            src="smartClient.ExportJavaScript/smartClient.ExportJavaScript.nocache.js"></script>
    <script type="text/javascript">

        var threedSession;

        function onThreedReady() {
            console.log("onThreedReady");
            var factory = new smartClient.api.ThreedSessionFactory();
            factory.setBrandKey("toyota");
            factory.setProfileKey("wStd");
            factory.setSeriesKey(2011, "avalon");
            var threedSessionFuture = factory.createSession();
            threedSessionFuture.success(function () {
                console.log("threedSession success");
                threedSession = threedSessionFuture.getResult();
                threedSession.setPicks(["Base", "V6", "6AT", "070"]);
                threedSession.addImageChangeListener2(function () {
                    refreshView();
                });
            });
        }

        function refreshView() {
            var imageStack = threedSession.getImageStack();
            var images = imageStack.getImageArray();
            var maxImageIndex = images.length - 1;
            var imageElements = document.querySelectorAll("#imageStack img");
            for (var index = 0; index < imageElements.length; index++) {
                var img = imageElements[index];
                if (index <= maxImageIndex) {
                    img.style.display = "block";
                    var image = images[index];
                    img.setAttribute("src", image.getSrc());
                } else {
                    img.style.display = "none";
                }
            }
        }

    </script>

    <style>
        img {
            width: 599px;
            height: 366px;
            position: absolute;
        }
    </style>
</head>
<body style="padding: 1em">

<div style="padding-bottom: 1em;">
    Image Mode:
    <input type="radio" name="imageMode" value="JPG" checked="checked" onclick="threedSession.setImageModeString('JPG')"/> JPG
    <input type="radio" name="imageMode" value="PNG" onclick="threedSession.setImageModeString('PNG')"/> PNG
</div>

<div style="padding-bottom: 1em;">
    Picks:
    <button onclick="threedSession.setPicks(['Base', 'V6', '6AT', '202']);">'Base', 'V6', '6AT', '202'</button>
    <button onclick="threedSession.setPicks(['LTD', 'V6', '6AT', '8N0']);">'LTD', 'V6', '6AT', '8N0'</button>
</div>

<div>

    <div style="width: 599px">
        <div style="padding-top: 1em;text-align: center">
            <button onclick="threedSession.previousAngle()">&lt;&lt;</button>
            <button onclick="threedSession.nextAngle()">&gt;&gt;</button>
        </div>
        <div id="imageStack" style="position: relative;">
            <img style="z-index: 10">
            <img style="z-index: 20">
            <img style="z-index: 30">
            <img style="z-index: 40">
            <img style="z-index: 50">
            <img style="z-index: 60">
            <img style="z-index: 70">
            <img style="z-index: 80">
            <img style="z-index: 90">
            <img style="z-index: 100">
        </div>


    </div>

</div>


</body>
</html>
